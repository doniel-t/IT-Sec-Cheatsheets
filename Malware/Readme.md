## Malware
- `Moderne Malware = Trojaner-Wurm`

### Transport Mechanismus
- `Trojaner`
  - Verbreitet sich durch Social Engineering (eg. Bewerbung.pdf.exe)
  - Installt z.B. Erpressungsschirm
  - **PUA (Potentially Unwanted App)**
    - Installer installiert unwanted software (eg. bing Toolbar)
- `Wurm`
  - analog: biologischer Wurm
  - "frisst" hosts resourcen
  - verbreitet sich typisch über Sicherheitslücken "im Netz"
    - z.B: **Buffer-Overflow**

- `Virus`
  - **Programm- / Makrovirus**
  - **Bootsektor Virus**
  - Viren vermehren sich selbständig (wie biologisch Virus)
  - Entwicklung:
    - Schadfunktionen
    - Tarnkappen-Viren (hides itself)
    - Polymorphe Viren (can change its own code / struktur )
  
### Schadfunktion
- `Goals:`
  - Daten manipulieren / löschen
    - `Klassische Viren`: löschen von Dateien
  - Daten ausspähen
    - `Keylogger`
    - `Spyware`
    - `Adware`
  - Nutzer erschrecken / erpressen
    - `Scareware` = "Rechner ist infiziert install HackMe-Antivirus"
    - `Ransomware` = Blockiert den Rechner, dadurch Erpressung
    - `Hoax`
  - Rechner fernsteuern
    - `Rootkit` = Adminrechte
      - Programm-Kits
      - Kernel-Rootkits
      - Userspace-Rootkits
      - `Gegenmaßnahmen:`
        - Static Kernel
        - Readonly Filesystem
        - `chkrootkit`
    - `Backdoor`
    - `Bot-Netz`


## Malware Scanner
- Heuristic
- Signaturbasiert
- Verhaltensbasiert
- Genauigkeit von Tests


## Drive By Downloads
- Auf "harmloser" Seite
  - Seite ist entweder gefaked oder manipuliert
  - durch z.B:
    - `SQL-Injection`
    - `Cross-Site-Scripting`
    - `Code-Injection` (try to avoid `"exec" or "eval"` at all cost, especially with userinput)
- "fauler" Link / Inhalt
- -> Download von Malware (meist unbemerkt / ohne Rückfrage)

## Buffer Overflows
- **Arten von Buffer Overflows:**
  - `Stack Overflow`
  - `Heap Overflow`
  - ...

- **Überschreiben des Stacks**
  - Ersetzen des Programm Counters (PC) -> points to "next to execute command" | can also jump (when calling function, jump back on function return)
  - Ausführen des eigenen Codes
  - **Stack:**
    - saves variablen / Rücksprungadresse etc
    - vorhergesehen größe des Speicherplatzes
    - Beim overflow:
      - Variablen / Rücksprungadresse werden corrupted
      - shellcode kann an den Speicheradressen injected werden
    - Wie overflowed man den Stack?
      - Userinputs :3 (über Tastatur / Web / Netzwerk ....)

- `Gegenmaßnahme:`
  - Canary (rand value that gets placed infront of Returnadress to detect Overflow attacks)
  - Non-Executable Stack